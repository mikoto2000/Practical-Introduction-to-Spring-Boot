---
title: アプリケーションの設定
---

# アプリケーションの設定

## `application.yaml` の作成

1. `src/main/resources` ディレクトリから `application.properties` を削除し、 `application.yaml` ファイルを作成
2. 以下のコードを `application.yaml` に追加
   ```yaml
   server:
     port: ${CREATEPROJECT_SERVER_PORT:8080}
   spring:
     profiles:
       active: local
       group:
         local:
           - local-logging
         prod:
           - prod-logging
   ```
3. 以下のコードを `application-local-logging.yaml` に追加
   ```yaml
   logging:
     level:
        root: DEBUG
   ```
4. 以下のコードを `application-prod-logging.yaml` に追加
   ```yaml
   logging:
     level:
        root: WARN
   ```

これにより、 `src/main/resources` ディレクトリの構成は以下のようになります。

```
src
 └── main
     └── resources
         ├── application.yaml
         ├── application-local-logging.yaml
         └── application-prod-logging.yaml
```

## プロファイルの切り替え

プロファイルが `active: local` と設定されているため、デフォルトではアプリケーション起動時に `application-local-logging.yaml` の設定が適用され、ログレベルが `DEBUG` に設定される。
起動時に、例えば `prod` プロファイルを指定すると、 `application-prod-logging.yaml` の設定が適用され、ログレベルが `WARN` に設定される。


## 環境変数の利用

`application.yaml` で `server.port` が `${CREATEPROJECT_SERVER_PORT:8080}` と設定されているため、環境変数 `CREATEPROJECT_SERVER_PORT` が設定されていればその値がポート番号として使用され、設定されていなければデフォルトで `8080` が使用される。


## まとめ

このように、Spring Boot では `application.yaml` を使用してアプリケーションの設定を柔軟に管理できる。
プロファイルを活用することで、開発環境と本番環境で異なる設定を簡単に切り替えることができる。
また、環境変数を利用することで、デプロイ先の環境に応じた設定を動的に変更することが可能となる。

DB やクラウドのエンドポイントなど、環境ごとに異なる設定が必要な場合に特に有用です。

例えば、以下のように環境依存の要素ごとにファイルを分けることもできる。

```src
 └── main
     └── resources
         ├── application.yaml
         ├── application-local-logging.yaml
         ├── application-prod-logging.yaml
         ├── application-local-db.yaml
         └── application-prod-db.yaml
```

